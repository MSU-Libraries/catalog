<?php
$selected = '';
foreach ($this->statusItems as $item) {
  if ($selected == '') {
    $selected = $item;
  } else if ($selected['status'] != 'Available') {
    if ($item['status'] == 'Available' || ($selected['status'] != 'Restricted' && $item['status'] == 'Restricted'))
      $selected = $item;
  }
}
?>
<div class="callnumAndLocation">
  <strong>Holdings:</strong>
  <span class="fullAvailability">
    <?php if ($selected['availability']): ?>
      <span class="text-success"><?=($selected['reserve'] == 'Y') ? $this->transEsc("On Reserve") : $this->transEsc("Available")?></span>
    <?php elseif ($selected['status'] == 'Restricted'): ?>
      <span class="text-warning"><?=$this->transEsc($selected['status'])?></span>
    <?php else: ?>
      <span class="text-danger"><?=$this->transEsc($selected['status'])?></span>
    <?php endif; ?>
  </span>
  at
  <span class="fullLocation">
    <?php $locationText = $this->transEscWithPrefix('location_', $selected['location']); ?>
    <?php if ($selected['locationhref'] ?? false): ?>
      <a href="<?=$selected['locationhref']?>" target="_blank"><?=$locationText?></a>
    <?php else: ?>
      <?=$locationText?>
    <?php endif; ?>
  </span>
  <span class="location"><?=$this->escapeHtml($location)?></span>
  with call number
  <span class="fullCallnumber">
    <?php if ($this->callnumberHandler): ?>
      <a href="<?=$this->url('alphabrowse-home') ?>?source=<?=$this->escapeHtmlAttr($this->callnumberHandler) ?>&amp;from=<?=$this->escapeHtmlAttr($selected['callnumber']) ?>"><?=$this->escapeHtml($callNumPrefix)?><?=$this->escapeHtml($selected['callnumber'])?></a>
    <?php else: ?>
      <?=$this->escapeHtml($callNumPrefix)?><?=$this->escapeHtml($selected['callnumber'])?>
    <?php endif; ?>
  </span>
</div>
