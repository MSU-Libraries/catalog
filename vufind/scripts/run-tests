#!/bin/bash

# Fail if any of these steps fail
set -e

cd /usr/local/vufind
echo "Running unit tests"
php vendor/bin/phpunit -c module/Catalog/tests/phpunit.xml /usr/local/vufind/module/Catalog/tests/unit-tests/ --stop-on-defect

if [[ -n "${1}" ]] && [[ "${1}" == "--unit" ]]; then
    echo "Skipping code quality tests"
else
    echo "Running code quality tests"
    vendor/bin/phing eslint jshint phpcs-console php-cs-fixer-dryrun phpstan-console
fi;
